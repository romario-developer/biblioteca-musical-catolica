<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Casamento - Biblioteca Musical Cat√≥lica</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <header class="header">
        <h1>üéµ Casamento</h1>
    </header>

    <main class="main-content">
        <h2 class="page-title">Momentos da Cerim√¥nia</h2>
        <div class="moments-grid">
            <div class="moment-item" onclick="openMusicList('Entrada dos padrinhos')"><h3>Entrada dos padrinhos</h3></div>
            <div class="moment-item" onclick="openMusicList('Entrada do noivo')"><h3>Entrada do noivo</h3></div>
            <div class="moment-item" onclick="openMusicList('Entrada da noiva')"><h3>Entrada da noiva</h3></div>
            <div class="moment-item" onclick="openMusicList('B√™n√ß√£o das alian√ßas')"><h3>B√™n√ß√£o das alian√ßas</h3></div>
            <div class="moment-item" onclick="openMusicList('Assinaturas')"><h3>Assinaturas</h3></div>
            <div class="moment-item" onclick="openMusicList('Sa√≠da dos noivos')"><h3>Sa√≠da dos noivos</h3></div>
            <div class="moment-item" onclick="openMusicList('Comunh√£o')"><h3>Comunh√£o</h3></div>
            <div class="moment-item" onclick="openMusicList('Outros')"><h3>Outros</h3></div>
        </div>
        <a href="index.html" class="back-button">‚Üê Voltar para o In√≠cio</a>
    </main>

    <div id="music-list-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-category-title">Categoria</h2>
                <button class="close-modal-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-music-list" class="modal-body"></div>
        </div>
    </div>

    <script>
        const modal = document.getElementById('music-list-modal');
        function closeModal() { modal.classList.remove('active'); }

        async function openMusicList(category) {
            const modalTitle = document.getElementById('modal-category-title');
            const musicListContainer = document.getElementById('modal-music-list');

            modalTitle.textContent = `Carregando ${category}...`;
            musicListContainer.innerHTML = '';
            modal.classList.add('active');

            try {
                const tempoLiturgico = 'Casamento'; // MUDE AQUI PARA CADA P√ÅGINA
                const url = `https://biblioteca-musical-catolica.onrender.com/api/musicas?tempo=${encodeURIComponent(tempoLiturgico )}&momento=${encodeURIComponent(category)}`;
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

                const songs = await response.json();
                modalTitle.textContent = category;

                if (songs.length > 0) {
                    musicListContainer.innerHTML = '';
                    songs.forEach(song => {
                        const item = document.createElement('div');
                        item.className = 'music-item';

                        const title = document.createElement('span');
                        title.className = 'music-title-span';
                        title.textContent = song.titulo;
                        item.appendChild(title);

                        const buttonsContainer = document.createElement('div');
                        buttonsContainer.className = 'action-buttons';

                        // Bot√£o de Letra (se houver link)
                        if (song.letraUrl) {
                            const letraLink = document.createElement('a');
                            letraLink.href = song.letraUrl;
                            letraLink.textContent = 'Letra';
                            letraLink.className = 'action-btn';
                            letraLink.setAttribute('target', '_blank');
                            buttonsContainer.appendChild(letraLink);
                        }

                        // Bot√£o de Cifra (se houver link)
                        if (song.cifraUrl) {
                            const cifraLink = document.createElement('a');
                            cifraLink.href = song.cifraUrl;
                            cifraLink.textContent = 'Cifra';
                            cifraLink.className = 'action-btn';
                            cifraLink.setAttribute('target', '_blank');
                            buttonsContainer.appendChild(cifraLink);
                        }

                        // Bot√£o de Baixar (sempre presente)
                        const downloadLink = document.createElement('a');
                        downloadLink.href = song.downloadUrl;
                        downloadLink.textContent = 'Baixar';
                        downloadLink.className = 'action-btn';
                        downloadLink.setAttribute('target', '_blank');
                        downloadLink.setAttribute('download', '');
                        buttonsContainer.appendChild(downloadLink);
                        
                        item.appendChild(buttonsContainer);
                        musicListContainer.appendChild(item);
                    });
                } else {
                    musicListContainer.innerHTML = '<p>Nenhuma m√∫sica encontrada para esta categoria.</p>';
                }
            } catch (error) {
                console.error('Erro ao buscar m√∫sicas:', error);
                modalTitle.textContent = category;
                musicListContainer.innerHTML = '<p>Ainda n√£o h√° m√∫sicas para esta categoria.</p>';
            }
        }
    </script>
</body>
</html>
